<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- <meta http-equiv="X-UA-Compatible" content="ie=edge"> -->
    <title>Server Side Calculator</title>
    <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
    <!-- <script src="vendors/jquery.min.js"></script> -->
    <!-- <script src="scripts/client.js"></script> -->
    <!-- <link rel="stylesheet" href="styles/styles.css"> -->
</head>
<body>
   
    <h1>Tweet Embed Spike</h1>
                                         
    <script>
      document.getElementById("demo").innerHTML = 
      "The full URL of this page is:<br>" + window.location.href;
    </script>
                               
<script defer type='text/javascript'>
//pull out url into variable to be easily swapped out

    let url= 'http://localhost:3000/#/books/'
            fetch('/api/tweets/1',
              { method: 'GET',
                mode: 'no-cors',
                                }
              ).then( response => response.json()

              ).then(data=> {
                  console.log('tweet ids:',data);

                  for(let i=0;i<data.length;i++){
                      console.log('tweet id', data[i].tweet_id);
                      
                      fetch('/api/tweets/1/' + data[i].tweet_id,
                      { method: 'GET',
                      mode: 'no-cors',
                                      }

                      ).then(response=> response.text()
                      
                      ).then(html => {console.log('this is the tweet html', html)
                                      
                          let tweetContainer = document.getElementById('viewTweets');
                          console.log(tweetContainer);

                          let tweetDiv = document.createElement('div');
                          console.log(html);
                            
                        // let tweetScript = '<script defer src="https://platform.twitter.com/widgets.js" charset="utf-8"><\/script>'
                            
                        // console.log(tweetScript);
                            //   let tweetHTML =  tweetScript + html     
                          tweetDiv.innerHTML = html;
                        //   console.log(tweetHTML);
                          tweetContainer.append(tweetDiv);

                      })

                  }}
                      ).catch((error) => {console.error('Error fetching embed html', error);}

              ).catch( error => console.error('Error fetching tweet ID', error) )
            
              </script>

<!-- <iframe src="index.html" title="W3Schools Free Online Web Tutorials"></iframe> -->
<div id='viewTweets'>
    </div>
</body>
</html>